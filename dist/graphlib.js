!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).graphlib={})}(this,(function(t){"use strict";var e=function(){function t(){this._arr=[],this._keyIndices={}}return t.prototype.size=function(){return this._arr.length},t.prototype.keys=function(){return this._arr.map((function(t){return t.key}))},t.prototype.has=function(t){return t in this._keyIndices},t.prototype.priority=function(t){var e=this._keyIndices[t];if(void 0!==e)return this._arr[e].priority},t.prototype.min=function(){if(0===this.size())throw new Error("Queue underflow");return this._arr[0].key},t.prototype.add=function(t,e){var r=this._keyIndices;if(!((t=String(t))in r)){var n=this._arr,i=n.length;return r[t]=i,n.push({key:t,priority:e}),this._decrease(i),!0}return!1},t.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var t=this._arr.pop();return delete this._keyIndices[t.key],this._heapify(0),t.key},t.prototype.decrease=function(t,e){var r=this._keyIndices[t];if(e>this._arr[r].priority)throw new Error("New priority is greater than current priority. Key: "+t+" Old: "+this._arr[r].priority+" New: "+e);this._arr[r].priority=e,this._decrease(r)},t.prototype._heapify=function(t){var e=this._arr,r=2*t,n=r+1,i=t;r<e.length&&(i=e[r].priority<e[i].priority?r:i,n<e.length&&(i=e[n].priority<e[i].priority?n:i),i!==t&&(this._swap(t,i),this._heapify(i)))},t.prototype._decrease=function(t){for(var e,r=this._arr,n=r[t].priority;0!==t&&!(r[e=t>>1].priority<n);)this._swap(t,e),t=e},t.prototype._swap=function(t,e){var r=this._arr,n=this._keyIndices,i=r[t],o=r[e];r[t]=o,r[e]=i,n[o.key]=t,n[i.key]=e},t}(),r=function(){return 1};function n(t,n,i,o){return function(t,r,n,i){var o,s,u={},h=new e,a=function(t){var e=t.v!==o?t.v:t.w,r=u[e],i=n(t),a=s.distance+i;if(i<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+t+" Weight: "+i);a<r.distance&&(r.distance=a,r.predecessor=o,h.decrease(e,a))};t.nodes().forEach((function(t){var e=t===r?0:Number.POSITIVE_INFINITY;u[t]={distance:e},h.add(t,e)}));for(;h.size()>0&&(o=h.removeMin(),(s=u[o]).distance!==Number.POSITIVE_INFINITY);)i(o).forEach(a);return u}(t,String(n),i||r,o||function(e){return t.outEdges(e)})}function i(t){var e=0,r=[],n={},i=[];function o(s){var u=n[s]={onStack:!0,lowlink:e,index:e++};if(r.push(s),t.successors(s).forEach((function(t){t in n?n[t].onStack&&(u.lowlink=Math.min(u.lowlink,n[t].index)):(o(t),u.lowlink=Math.min(u.lowlink,n[t].lowlink))})),u.lowlink===u.index){var h,a=[];do{h=r.pop(),n[h].onStack=!1,a.push(h)}while(s!==h);i.push(a)}}return t.nodes().forEach((function(t){t in n||o(t)})),i}var o=function(){return 1};var s=function(){};function u(t){var e={},r={},n=[];function i(o){if(o in r)throw new s;if(!(o in e)){r[o]=!0,e[o]=!0;for(var u=0,h=t.predecessors(o);u<h.length;u++){i(h[u])}delete r[o],n.push(o)}}for(var o=0,u=t.sinks();o<u.length;o++){i(u[o])}if(Object.keys(e).length!==t.nodeCount())throw new s;return n}function h(t,e,r){for(var n=Array.isArray(e)?e:[e],i=(t.isDirected()?t.successors:t.neighbors).bind(t),o=[],s={},u=0,h=n;u<h.length;u++){var d=h[u];if(!t.hasNode(d))throw new Error("Graph does not have node: "+d);a(t,d,"post"===r,s,i,o)}return o}function a(t,e,r,n,i,o){if(!(e in n)){n[e]=!0,r||o.push(e);for(var s=0,u=i(e);s<u.length;s++){a(t,u[s],r,n,i,o)}r&&o.push(e)}}s.prototype=new Error;var d=function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),i=0;for(e=0;e<r;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)n[i]=o[s];return n};function c(t,e){return!!t&&t.hasOwnProperty(e)}function f(t){return void 0===t}function p(t,e){for(var r=0,n=Object.keys(t);r<n.length;r++){var i=n[r];e(t[i],i)}}function l(t){return 0===Object.keys(t).length}var _,v=(_=function(t,e){return(_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}_(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),g="\0",y=function(){function t(t){void 0===t&&(t={}),this._label=void 0,this._nodeCount=0,this._edgeCount=0,this._isDirected=!c(t,"directed")||t.directed,this._isMultigraph=!!c(t,"multigraph")&&t.multigraph,this._isCompound=!!c(t,"compound")&&t.compound,this._defaultNodeLabelFn=function(){},this._defaultEdgeLabelFn=function(){},this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children["\0"]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}return t.prototype.isDirected=function(){return this._isDirected},t.prototype.isMultigraph=function(){return this._isMultigraph},t.prototype.isCompound=function(){return this._isCompound},t.prototype.setGraph=function(t){return this._label=t,this},t.prototype.graph=function(){return this._label},t.prototype.setDefaultNodeLabel=function(t){var e;return e=t,this._defaultNodeLabelFn="function"!=typeof e?function(){return t}:t,this},t.prototype.nodeCount=function(){return this._nodeCount},t.prototype.nodes=function(){return Object.keys(this._nodes)},t.prototype.sources=function(){var t=this;return this.nodes().filter((function(e){return l(t._in[e])}))},t.prototype.sinks=function(){var t=this;return this.nodes().filter((function(e){return l(t._out[e])}))},t.prototype.setNodes=function(t,e){for(var r=0,n=t;r<n.length;r++){var i=n[r];void 0!==e?this.setNode(i,e):this.setNode(i)}return this},t.prototype.setNode=function(t,e){return c(this._nodes,t)?(arguments.length>1&&(this._nodes[t]=e),this):(this._nodes[t]=arguments.length>1?e:this._defaultNodeLabelFn(t),this._isCompound&&(this._parent[t]=g,this._children[t]={},this._children["\0"][t]=!0),this._in[t]={},this._preds[t]={},this._out[t]={},this._sucs[t]={},++this._nodeCount,this)},t.prototype.node=function(t){return this._nodes[t]},t.prototype.hasNode=function(t){return c(this._nodes,t)},t.prototype.removeNode=function(t){var e=this,r=this;if(c(this._nodes,t)){var n=function(t){r.removeEdge(e._edgeObjs[t])};if(delete this._nodes[t],this._isCompound){this._removeFromParentsChildList(t),delete this._parent[t];for(var i=0,o=this.children(t);i<o.length;i++){var s=o[i];r.setParent(s)}delete this._children[t]}for(var u=0,h=Object.keys(this._in[t]);u<h.length;u++){n(h[u])}delete this._in[t],delete this._preds[t];for(var a=0,d=Object.keys(this._out[t]);a<d.length;a++){n(d[a])}delete this._out[t],delete this._sucs[t],--this._nodeCount}return this},t.prototype.setParent=function(t,e){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(void 0===e)e=g;else{for(var r=e+="";!f(r);r=this.parent(r))if(r===t)throw new Error("Setting "+e+" as parent of "+t+" would create a cycle");this.setNode(e)}return this.setNode(t),this._removeFromParentsChildList(t),this._parent[t]=e,this._children[e][t]=!0,this},t.prototype._removeFromParentsChildList=function(t){delete this._children[this._parent[t]][t]},t.prototype.parent=function(t){if(this._isCompound){var e=this._parent[t];if(e!==g)return e}},t.prototype.children=function(t){if(f(t)&&(t=g),this._isCompound){var e=this._children[t];return e?Object.keys(e):void 0}return t===g?this.nodes():this.hasNode(t)?[]:void 0},t.prototype.predecessors=function(t){var e=this._preds[t];if(e)return Object.keys(e)},t.prototype.successors=function(t){var e=this._sucs[t];if(e)return Object.keys(e)},t.prototype.neighbors=function(t){var e=this.predecessors(t);if(e)return function(t,e){for(var r=d(t),n=0,i=e;n<i.length;n++){var o=i[n];-1===r.indexOf(o)&&r.push(o)}return r}(e,this.successors(t))},t.prototype.isLeaf=function(t){return 0===(this.isDirected()?this.successors(t):this.neighbors(t)).length},t.prototype.filterNodes=function(e){var r=new t({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});r.setGraph(this.graph());var n=this;p(this._nodes,(function(t,n){e(n)&&r.setNode(n,t)})),p(this._edgeObjs,(function(t){r.hasNode(t.v)&&r.hasNode(t.w)&&r.setEdge(t,n.edge(t))}));var i={};function o(t){var e=n.parent(t);return void 0===e||r.hasNode(e)?(i[t]=e,e):e in i?i[e]:o(e)}if(this._isCompound)for(var s=0,u=r.nodes();s<u.length;s++){var h=u[s];r.setParent(h,o(h))}return r},t.prototype.setDefaultEdgeLabel=function(t){var e;return e=t,this._defaultEdgeLabelFn="function"!=typeof e?function(){return t}:t,this},t.prototype.edgeCount=function(){return this._edgeCount},t.prototype.edges=function(){return Object.values(this._edgeObjs)},t.prototype.setPath=function(t,e){var r=this,n=arguments;return t.reduce((function(t,i){return n.length>1?r.setEdge(t,i,e):r.setEdge(t,i),i})),this},t.prototype.setEdge=function(t,e,r,n){var i=!1,o=t;"object"==typeof o&&null!==o&&"v"in o?(t=o.v,e=o.w,n=o.name,2===arguments.length&&(r=arguments[1],i=!0)):(t=o,e=arguments[1],n=arguments[3],arguments.length>2&&(r=arguments[2],i=!0)),t=""+t,e=""+e,f(n)||(n=""+n);var s=E(this._isDirected,t,e,n);if(c(this._edgeLabels,s))return i&&(this._edgeLabels[s]=r),this;if(!f(n)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(t),this.setNode(e),this._edgeLabels[s]=i?r:this._defaultEdgeLabelFn(t,e,n);var u=k(this._isDirected,t,e,n);return t=u.v,e=u.w,Object.freeze(u),this._edgeObjs[s]=u,b(this._preds[e],t),b(this._sucs[t],e),this._in[e][s]=u,this._out[t][s]=u,this._edgeCount++,this},t.prototype.edge=function(t,e,r){var n="object"==typeof t?N(this._isDirected,t):E(this._isDirected,t,e,r);return this._edgeLabels[n]},t.prototype.hasEdge=function(t,e,r){var n=1===arguments.length?N(this._isDirected,arguments[0]):E(this._isDirected,t,e,r);return c(this._edgeLabels,n)},t.prototype.removeEdge=function(t,e,r){var n="object"==typeof t?N(this._isDirected,t):E(this._isDirected,t,e,r),i=this._edgeObjs[n];return i&&(t=i.v,e=i.w,delete this._edgeLabels[n],delete this._edgeObjs[n],m(this._preds[e],t),m(this._sucs[t],e),delete this._in[e][n],delete this._out[t][n],this._edgeCount--),this},t.prototype.inEdges=function(t,e){var r=this._in[t];if(r){var n=Object.values(r);return e?n.filter((function(t){return t.v===e})):n}},t.prototype.outEdges=function(t,e){var r=this._out[t];if(r){var n=Object.values(r);return e?n.filter((function(t){return t.w===e})):n}},t.prototype.nodeEdges=function(t,e){var r=this.inEdges(t,e);if(r)return r.concat(this.outEdges(t,e))},t}(),w=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return v(e,t),e}(y);function b(t,e){t[e]?t[e]++:t[e]=1}function m(t,e){--t[e]||delete t[e]}function E(t,e,r,n){var i=""+e,o=""+r;if(!t&&i>o){var s=i;i=o,o=s}return i+""+o+""+(f(n)?"\0":n)}function k(t,e,r,n){var i=""+e,o=""+r;if(!t&&i>o){var s=i;i=o,o=s}var u={v:i,w:o};return n&&(u.name=n),u}function N(t,e){return E(t,e.v,e.w,e.name)}var O=Object.freeze({__proto__:null,components:function(t){var e,r={},n=[];function i(n){if(!(n in r)){r[n]=!0,e.push(n);for(var o=0,s=t.successors(n);o<s.length;o++){i(s[o])}for(var u=0,h=t.predecessors(n);u<h.length;u++){i(h[u])}}}for(var o=0,s=t.nodes();o<s.length;o++){var u=s[o];e=[],i(u),e.length&&n.push(e)}return n},dijkstra:n,dijkstraAll:function(t,e,r){for(var i={},o=0,s=t.nodes();o<s.length;o++){var u=s[o];i[u]=n(t,u,e,r)}return i},findCycles:function(t){return i(t).filter((function(e){return e.length>1||1===e.length&&t.hasEdge(e[0],e[0])}))},floydWarshall:function(t,e,r){return function(t,e,r){var n={},i=t.nodes();return i.forEach((function(t){n[t]={},n[t][t]={distance:0},i.forEach((function(e){t!==e&&(n[t][e]={distance:Number.POSITIVE_INFINITY})})),r(t).forEach((function(r){var i=r.v===t?r.w:r.v,o=e(r);n[t][i]={distance:o,predecessor:t}}))})),i.forEach((function(t){var e=n[t];i.forEach((function(r){var o=n[r];i.forEach((function(r){var n=o[t],i=e[r],s=o[r],u=n.distance+i.distance;u<s.distance&&(s.distance=u,s.predecessor=i.predecessor)}))}))})),n}(t,e||o,r||function(e){return t.outEdges(e)})},isAcyclic:function(t){try{u(t)}catch(t){if(t instanceof s)return!1;throw t}return!0},postorder:function(t,e){return h(t,e,"post")},preorder:function(t,e){return h(t,e,"pre")},prim:function(t,r){var n,i=new w({}),o={},s=new e;function u(t){var e=t.v===n?t.w:t.v,i=s.priority(e);if(void 0!==i){var u=r(t);u<i&&(o[e]=n,s.decrease(e,u))}}if(0===t.nodeCount())return i;for(var h=0,a=t.nodes();h<a.length;h++)n=a[h],s.add(n,Number.POSITIVE_INFINITY),i.setNode(n);s.decrease(t.nodes()[0],0);for(var d=!1;s.size()>0;){if((n=s.removeMin())in o)i.setEdge(n,o[n]);else{if(d)throw new Error("Input graph is not connected: "+t);d=!0}t.nodeEdges(n).forEach(u)}return i},tarjan:i,topsort:u});function j(t){return t.nodes().map((function(e){var r=t.node(e),n=t.parent(e),i={v:e};return void 0!==r&&(i.value=r),void 0!==n&&(i.parent=n),i}))}function C(t){return t.edges().map((function(e){var r=t.edge(e),n={v:e.v,w:e.w};return void 0!==e.name&&(n.name=e.name),void 0!==r&&(n.value=r),n}))}var I=Object.freeze({__proto__:null,write:function(t){var e={options:{directed:t.isDirected(),multigraph:t.isMultigraph(),compound:t.isCompound()},nodes:j(t),edges:C(t)};return void 0!==t.graph()&&(e.value=JSON.parse(JSON.stringify(t.graph()))),e},read:function(t){for(var e=new y(t.options).setGraph(t.value),r=0,n=t.nodes;r<n.length;r++){var i=n[r];e.setNode(i.v,i.value),i.parent&&e.setParent(i.v,i.parent)}for(var o=0,s=t.edges;o<s.length;o++){i=s[o];e.setEdge({v:i.v,w:i.w,name:i.name},i.value)}return e}});t.Graph=y,t.GraphLike=w,t.PriorityQueue=e,t.alg=O,t.json=I,t.version="0.0.0",Object.defineProperty(t,"__esModule",{value:!0})}));
